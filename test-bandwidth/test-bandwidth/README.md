# 테스트 코드 대여폭


## Mocking 테스트에 대해서

1. mocking 테스트는 왜해야 하는가 ?
2. 내부 인프라는 mocking 테스트를 피해야 하는 이유
   1. 내부 인프라에 대한 실제 검증은? 어차피 해야 한다.
   2. mocking을 하는 이유는 내 관심사에 맞는 부분만 신경 중점으로 보고 싶고 그 외부 문제 (인프라 등등등)은 신경쓰지 않겠다. -> 테스트 대역폭을 넓게 하기 위함 임. 이부분은 POJO 테스트 및 인터페이스를 통한 목킹으로 해결
3. mocking이 필요한 구간은?
   1. 외부 인프라에 대한 통제권은 우리에게 없기 때문에 외부 테스트는 mocking 해야한다.
   2. 인프라에 대한 mocking의 어려움 HTTP mocking 에대한 어려움 (포트 충돌, HTTP 목킹 자체의 어려움, Netty Mock server 포트 랜덤 문제)
      1. 그렇다면 필요 없다는 것인가? 그렇지 않음 HTTP 통신에 대한 핵심 시리얼라이즈 언시리얼라이즈 및 HTTP Status code에 따른 분기문 테스트 가능
   3. 인터페이스를 기반으로 Mocking
      1. Spring Bean 기반으로 테스트, @Profile, @TestConfiguration 사용법 정리
      2. static 목킹 방법
      3. Batch application application 환율 정보 mocking 하여 테스트 가변적 테스트 방법



## POJO 테스트

1. POJO 테스트를 권장 하는 이유
   1. 인프라가 반드시 필요한 테스트에 해당 로직을 한 번더 내려서 POJO 기반으로 테스트 하는 방법 소개
   2. 테스트 대역을 폭넓게 하여 다양한 케이스를 커버하기 위해서는 다양한 케이스가 필요함 이런 경우 케이스를 다양하게 주기 위해서는 반드시 인프라가 필요해지고, 그에 따른 테스트 빌드 과정도 늦어짐
   3. 모든 경우에 적용해야 하는가? 그건 그렇지 않다고 생각함 필요 로직이 복잡해서 다양한 케이스가 필요한 경우에 적합 간단한 연산 작업은 그냥 계층으 두지 않고 생각 하고 있음


## 결론
좋은 테스트 코드를 작성하는 것은 결국 실제 구현 코드에 대한 부분으로 귀결 됩니다. 당연한 이야기 겠지만 구현 코드가 테스트 하기 쉬운 코드이어야 테스트가 쉬워지고 그 결과로 다양한 대역폭을 커버할 수 있게 되어 의미가 의미가 높아지게 된다고 생각 합니다. 

여기서 중요한 것은 구현 코드에 대한 부분을 어떻게 바라볼 것인가 입니다. 팀내에서 어느 계층을 어떻게 바라 볼것이고 어떻게 구현하고 테스트할 것인지에 대한 내부적인 합의가 있고 이것을 모두 얼라인 하여 지키는 것이 무엇보다 주요하다 

어느 계층을 어떻게 보고 각 계층에 대한 단위 테스트, 그 계층을 모두 이어서 하는 테스트 